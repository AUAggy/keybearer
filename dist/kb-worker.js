(()=>{function Ot(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function lt(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function ut(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function R(e,...t){if(!Ot(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function _t(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function vt(e,t){R(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function W(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function z(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function ce(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}var fe=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function ae(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function xt(e){if(typeof e=="string")e=ae(e);else if(Ot(e))e=dt(e);else throw new Error("Uint8Array expected, got "+typeof e);return e}function Pt(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function Kt(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return r===0}var At=(e,t)=>{function r(n,...o){if(R(n),!fe)throw new Error("Non little-endian hardware is not yet supported");if(e.nonceLength!==void 0){let u=o[0];if(!u)throw new Error("nonce / iv required");e.varSizeNonce?R(u):R(u,e.nonceLength)}let i=e.tagLength;i&&o[1]!==void 0&&R(o[1]);let s=t(n,...o),c=(u,h)=>{if(h!==void 0){if(u!==2)throw new Error("cipher output not supported");R(h)}},a=!1;return{encrypt(u,h){if(a)throw new Error("cannot encrypt() twice with same key + nonce");return a=!0,R(u),c(s.encrypt.length,h),s.encrypt(u,h)},decrypt(u,h){if(R(u),i&&u.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return c(s.decrypt.length,h),s.decrypt(u,h)}}}return Object.assign(r,e),r};function Lt(e,t,r=!0){if(t===void 0)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(r&&!he(t))throw new Error("invalid output, must be aligned");return t}function Tt(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let o=BigInt(32),i=BigInt(4294967295),s=Number(r>>o&i),c=Number(r&i),a=n?4:0,l=n?0:4;e.setUint32(t+a,s,n),e.setUint32(t+l,c,n)}function Dt(e,t,r){lt(r);let n=new Uint8Array(16),o=ce(n);return Tt(o,0,BigInt(t),r),Tt(o,8,BigInt(e),r),n}function he(e){return e.byteOffset%4===0}function dt(e){return Uint8Array.from(e)}var Rt=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),le=Rt("expand 16-byte k"),ue=Rt("expand 32-byte k"),xe=W(le),de=W(ue);function x(e,t){return e<<t|e>>>32-t}function Bt(e){return e.byteOffset%4===0}var pt=64,pe=16,Gt=2**32-1,Nt=new Uint32Array;function ye(e,t,r,n,o,i,s,c){let a=o.length,l=new Uint8Array(pt),u=W(l),h=Bt(o)&&Bt(i),p=h?W(o):Nt,g=h?W(i):Nt;for(let y=0;y<a;s++){if(e(t,r,n,u,s,c),s>=Gt)throw new Error("arx: counter overflow");let b=Math.min(pt,a-y);if(h&&b===pt){let w=y/4;if(y%4!==0)throw new Error("arx: invalid block position");for(let m=0,_;m<pe;m++)_=w+m,g[_]=p[_]^u[m];y+=pt;continue}for(let w=0,m;w<b;w++)m=y+w,i[m]=o[m]^l[w];y+=b}}function kt(e,t){let{allowShortKeys:r,extendNonceFn:n,counterLength:o,counterRight:i,rounds:s}=Pt({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return ut(o),ut(s),lt(i),lt(r),(c,a,l,u,h=0)=>{R(c),R(a),R(l);let p=l.length;if(u===void 0&&(u=new Uint8Array(p)),R(u),ut(h),h<0||h>=Gt)throw new Error("arx: counter overflow");if(u.length<p)throw new Error(`arx: output (${u.length}) is shorter than data (${p})`);let g=[],y=c.length,b,w;if(y===32)g.push(b=dt(c)),w=de;else if(y===16&&r)b=new Uint8Array(32),b.set(c),b.set(c,16),w=xe,g.push(b);else throw new Error(`arx: invalid 32-byte key, got length=${y}`);Bt(a)||g.push(a=dt(a));let m=W(b);if(n){if(a.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(w,m,W(a.subarray(0,16)),m),a=a.subarray(16)}let _=16-o;if(_!==a.length)throw new Error(`arx: nonce must be ${_} or 16 bytes`);if(_!==12){let v=new Uint8Array(12);v.set(a,i?0:12-a.length),a=v,g.push(a)}let T=W(a);return ye(e,w,m,T,l,u,h,s),z(...g),u}}var P=(e,t)=>e[t++]&255|(e[t++]&255)<<8,Ut=class{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=xt(t),R(t,32);let r=P(t,0),n=P(t,2),o=P(t,4),i=P(t,6),s=P(t,8),c=P(t,10),a=P(t,12),l=P(t,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|o<<6)&7939,this.r[3]=(o>>>7|i<<9)&8191,this.r[4]=(i>>>4|s<<12)&255,this.r[5]=s>>>1&8190,this.r[6]=(s>>>14|c<<2)&8191,this.r[7]=(c>>>11|a<<5)&8065,this.r[8]=(a>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=P(t,16+2*u)}process(t,r,n=!1){let o=n?0:2048,{h:i,r:s}=this,c=s[0],a=s[1],l=s[2],u=s[3],h=s[4],p=s[5],g=s[6],y=s[7],b=s[8],w=s[9],m=P(t,r+0),_=P(t,r+2),T=P(t,r+4),v=P(t,r+6),V=P(t,r+8),K=P(t,r+10),D=P(t,r+12),N=P(t,r+14),A=i[0]+(m&8191),L=i[1]+((m>>>13|_<<3)&8191),B=i[2]+((_>>>10|T<<6)&8191),k=i[3]+((T>>>7|v<<9)&8191),U=i[4]+((v>>>4|V<<12)&8191),H=i[5]+(V>>>1&8191),E=i[6]+((V>>>14|K<<2)&8191),C=i[7]+((K>>>11|D<<5)&8191),S=i[8]+((D>>>8|N<<8)&8191),j=i[9]+(N>>>5|o),d=0,I=d+A*c+L*(5*w)+B*(5*b)+k*(5*y)+U*(5*g);d=I>>>13,I&=8191,I+=H*(5*p)+E*(5*h)+C*(5*u)+S*(5*l)+j*(5*a),d+=I>>>13,I&=8191;let O=d+A*a+L*c+B*(5*w)+k*(5*b)+U*(5*y);d=O>>>13,O&=8191,O+=H*(5*g)+E*(5*p)+C*(5*h)+S*(5*u)+j*(5*l),d+=O>>>13,O&=8191;let F=d+A*l+L*a+B*c+k*(5*w)+U*(5*b);d=F>>>13,F&=8191,F+=H*(5*y)+E*(5*g)+C*(5*p)+S*(5*h)+j*(5*u),d+=F>>>13,F&=8191;let M=d+A*u+L*l+B*a+k*c+U*(5*w);d=M>>>13,M&=8191,M+=H*(5*b)+E*(5*y)+C*(5*g)+S*(5*p)+j*(5*h),d+=M>>>13,M&=8191;let Y=d+A*h+L*u+B*l+k*a+U*c;d=Y>>>13,Y&=8191,Y+=H*(5*w)+E*(5*b)+C*(5*y)+S*(5*g)+j*(5*p),d+=Y>>>13,Y&=8191;let Q=d+A*p+L*h+B*u+k*l+U*a;d=Q>>>13,Q&=8191,Q+=H*c+E*(5*w)+C*(5*b)+S*(5*y)+j*(5*g),d+=Q>>>13,Q&=8191;let tt=d+A*g+L*p+B*h+k*u+U*l;d=tt>>>13,tt&=8191,tt+=H*a+E*c+C*(5*w)+S*(5*b)+j*(5*y),d+=tt>>>13,tt&=8191;let et=d+A*y+L*g+B*p+k*h+U*u;d=et>>>13,et&=8191,et+=H*l+E*a+C*c+S*(5*w)+j*(5*b),d+=et>>>13,et&=8191;let nt=d+A*b+L*y+B*g+k*p+U*h;d=nt>>>13,nt&=8191,nt+=H*u+E*l+C*a+S*c+j*(5*w),d+=nt>>>13,nt&=8191;let rt=d+A*w+L*b+B*y+k*g+U*p;d=rt>>>13,rt&=8191,rt+=H*h+E*u+C*l+S*a+j*c,d+=rt>>>13,rt&=8191,d=(d<<2)+d|0,d=d+I|0,I=d&8191,d=d>>>13,O+=d,i[0]=I,i[1]=O,i[2]=F,i[3]=M,i[4]=Y,i[5]=Q,i[6]=tt,i[7]=et,i[8]=nt,i[9]=rt}finalize(){let{h:t,pad:r}=this,n=new Uint16Array(10),o=t[1]>>>13;t[1]&=8191;for(let c=2;c<10;c++)t[c]+=o,o=t[c]>>>13,t[c]&=8191;t[0]+=o*5,o=t[0]>>>13,t[0]&=8191,t[1]+=o,o=t[1]>>>13,t[1]&=8191,t[2]+=o,n[0]=t[0]+5,o=n[0]>>>13,n[0]&=8191;for(let c=1;c<10;c++)n[c]=t[c]+o,o=n[c]>>>13,n[c]&=8191;n[9]-=8192;let i=(o^1)-1;for(let c=0;c<10;c++)n[c]&=i;i=~i;for(let c=0;c<10;c++)t[c]=t[c]&i|n[c];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let s=t[0]+r[0];t[0]=s&65535;for(let c=1;c<8;c++)s=(t[c]+r[c]|0)+(s>>>16)|0,t[c]=s&65535;z(n)}update(t){_t(this),t=xt(t),R(t);let{buffer:r,blockLen:n}=this,o=t.length;for(let i=0;i<o;){let s=Math.min(n-this.pos,o-i);if(s===n){for(;n<=o-i;i+=n)this.process(t,i);continue}r.set(t.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){z(this.h,this.r,this.buffer,this.pad)}digestInto(t){_t(this),vt(t,this),this.finished=!0;let{buffer:r,h:n}=this,{pos:o}=this;if(o){for(r[o++]=1;o<16;o++)r[o]=0;this.process(r,0,!0)}this.finalize();let i=0;for(let s=0;s<8;s++)t[i++]=n[s]>>>0,t[i++]=n[s]>>>8;return t}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}};function be(e){let t=(n,o)=>e(o).update(xt(n)).digest(),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}var Vt=be(e=>new Ut(e));function zt(e,t,r,n,o,i=20){let s=e[0],c=e[1],a=e[2],l=e[3],u=t[0],h=t[1],p=t[2],g=t[3],y=t[4],b=t[5],w=t[6],m=t[7],_=o,T=r[0],v=r[1],V=r[2],K=s,D=c,N=a,A=l,L=u,B=h,k=p,U=g,H=y,E=b,C=w,S=m,j=_,d=T,I=v,O=V;for(let M=0;M<i;M+=2)K=K+L|0,j=x(j^K,16),H=H+j|0,L=x(L^H,12),K=K+L|0,j=x(j^K,8),H=H+j|0,L=x(L^H,7),D=D+B|0,d=x(d^D,16),E=E+d|0,B=x(B^E,12),D=D+B|0,d=x(d^D,8),E=E+d|0,B=x(B^E,7),N=N+k|0,I=x(I^N,16),C=C+I|0,k=x(k^C,12),N=N+k|0,I=x(I^N,8),C=C+I|0,k=x(k^C,7),A=A+U|0,O=x(O^A,16),S=S+O|0,U=x(U^S,12),A=A+U|0,O=x(O^A,8),S=S+O|0,U=x(U^S,7),K=K+B|0,O=x(O^K,16),C=C+O|0,B=x(B^C,12),K=K+B|0,O=x(O^K,8),C=C+O|0,B=x(B^C,7),D=D+k|0,j=x(j^D,16),S=S+j|0,k=x(k^S,12),D=D+k|0,j=x(j^D,8),S=S+j|0,k=x(k^S,7),N=N+U|0,d=x(d^N,16),H=H+d|0,U=x(U^H,12),N=N+U|0,d=x(d^N,8),H=H+d|0,U=x(U^H,7),A=A+L|0,I=x(I^A,16),E=E+I|0,L=x(L^E,12),A=A+L|0,I=x(I^A,8),E=E+I|0,L=x(L^E,7);let F=0;n[F++]=s+K|0,n[F++]=c+D|0,n[F++]=a+N|0,n[F++]=l+A|0,n[F++]=u+L|0,n[F++]=h+B|0,n[F++]=p+k|0,n[F++]=g+U|0,n[F++]=y+H|0,n[F++]=b+E|0,n[F++]=w+C|0,n[F++]=m+S|0,n[F++]=_+j|0,n[F++]=T+d|0,n[F++]=v+I|0,n[F++]=V+O|0}function ge(e,t,r,n){let o=e[0],i=e[1],s=e[2],c=e[3],a=t[0],l=t[1],u=t[2],h=t[3],p=t[4],g=t[5],y=t[6],b=t[7],w=r[0],m=r[1],_=r[2],T=r[3];for(let V=0;V<20;V+=2)o=o+a|0,w=x(w^o,16),p=p+w|0,a=x(a^p,12),o=o+a|0,w=x(w^o,8),p=p+w|0,a=x(a^p,7),i=i+l|0,m=x(m^i,16),g=g+m|0,l=x(l^g,12),i=i+l|0,m=x(m^i,8),g=g+m|0,l=x(l^g,7),s=s+u|0,_=x(_^s,16),y=y+_|0,u=x(u^y,12),s=s+u|0,_=x(_^s,8),y=y+_|0,u=x(u^y,7),c=c+h|0,T=x(T^c,16),b=b+T|0,h=x(h^b,12),c=c+h|0,T=x(T^c,8),b=b+T|0,h=x(h^b,7),o=o+l|0,T=x(T^o,16),y=y+T|0,l=x(l^y,12),o=o+l|0,T=x(T^o,8),y=y+T|0,l=x(l^y,7),i=i+u|0,w=x(w^i,16),b=b+w|0,u=x(u^b,12),i=i+u|0,w=x(w^i,8),b=b+w|0,u=x(u^b,7),s=s+h|0,m=x(m^s,16),p=p+m|0,h=x(h^p,12),s=s+h|0,m=x(m^s,8),p=p+m|0,h=x(h^p,7),c=c+a|0,_=x(_^c,16),g=g+_|0,a=x(a^g,12),c=c+a|0,_=x(_^c,8),g=g+_|0,a=x(a^g,7);let v=0;n[v++]=o,n[v++]=i,n[v++]=s,n[v++]=c,n[v++]=w,n[v++]=m,n[v++]=_,n[v++]=T}var we=kt(zt,{counterRight:!1,counterLength:4,allowShortKeys:!1}),me=kt(zt,{counterRight:!1,counterLength:8,extendNonceFn:ge,allowShortKeys:!1});var _e=new Uint8Array(16),Mt=(e,t)=>{e.update(t);let r=t.length%16;r&&e.update(_e.subarray(r))},Ae=new Uint8Array(32);function Wt(e,t,r,n,o){let i=e(t,r,Ae),s=Vt.create(i);o&&Mt(s,o),Mt(s,n);let c=Dt(n.length,o?o.length:0,!0);s.update(c);let a=s.digest();return z(i,c),a}var Jt=e=>(t,r,n)=>({encrypt(i,s){let c=i.length;s=Lt(c+16,s,!1),s.set(i);let a=s.subarray(0,-16);e(t,r,a,a,1);let l=Wt(e,t,r,a,n);return s.set(l,c),z(l),s},decrypt(i,s){s=Lt(i.length-16,s,!1);let c=i.subarray(0,-16),a=i.subarray(-16),l=Wt(e,t,r,c,n);if(!Kt(a,l))throw new Error("invalid tag");return s.set(i.subarray(0,-16)),e(t,r,s,s,1),z(l),s}}),Ht=At({blockSize:64,nonceLength:12,tagLength:16},Jt(we)),Ne=At({blockSize:64,nonceLength:24,tagLength:16},Jt(me));function Le(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function ot(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Z(e,...t){if(!Le(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function yt(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");ot(e.outputLen),ot(e.blockLen)}function it(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function $t(e,t){Z(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function J(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function ct(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function G(e,t){return e<<32-t|e>>>t}function qt(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function ht(e){return typeof e=="string"&&(e=qt(e)),Z(e),e}function Et(e){return typeof e=="string"&&(e=qt(e)),Z(e),e}function Xt(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("options should be object or undefined");return Object.assign(e,t)}var st=class{};function Zt(e){let t=n=>e().update(ht(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}var bt=class extends st{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,yt(t);let n=ht(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,i=new Uint8Array(o);i.set(n.length>o?t.create().update(n).digest():n);for(let s=0;s<i.length;s++)i[s]^=54;this.iHash.update(i),this.oHash=t.create();for(let s=0;s<i.length;s++)i[s]^=106;this.oHash.update(i),J(i)}update(t){return it(this),this.iHash.update(t),this}digestInto(t){it(this),Z(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:o,destroyed:i,blockLen:s,outputLen:c}=this;return t=t,t.finished=o,t.destroyed=i,t.blockLen=s,t.outputLen=c,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Ct=(e,t,r)=>new bt(e,t).update(r).digest();Ct.create=(e,t)=>new bt(e,t);function Be(e,t,r,n){yt(e);let o=Xt({dkLen:32,asyncTick:10},n),{c:i,dkLen:s,asyncTick:c}=o;if(ot(i),ot(s),ot(c),i<1)throw new Error("iterations (c) should be >= 1");let a=Et(t),l=Et(r),u=new Uint8Array(s),h=Ct.create(e,a),p=h._cloneInto().update(l);return{c:i,dkLen:s,asyncTick:c,DK:u,PRF:h,PRFSalt:p}}function ke(e,t,r,n,o){return e.destroy(),t.destroy(),n&&n.destroy(),J(o),r}function Yt(e,t,r,n){let{c:o,dkLen:i,DK:s,PRF:c,PRFSalt:a}=Be(e,t,r,n),l,u=new Uint8Array(4),h=ct(u),p=new Uint8Array(c.outputLen);for(let g=1,y=0;y<i;g++,y+=c.outputLen){let b=s.subarray(y,y+c.outputLen);h.setInt32(0,g,!1),(l=a._cloneInto(l)).update(u).digestInto(p),b.set(p.subarray(0,b.length));for(let w=1;w<o;w++){c._cloneInto(l).update(p).digestInto(p);for(let m=0;m<b.length;m++)b[m]^=p[m]}}return ke(c,a,s,l,p)}function Ue(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let o=BigInt(32),i=BigInt(4294967295),s=Number(r>>o&i),c=Number(r&i),a=n?4:0,l=n?0:4;e.setUint32(t+a,s,n),e.setUint32(t+l,c,n)}function Qt(e,t,r){return e&t^~e&r}function te(e,t,r){return e&t^e&r^t&r}var gt=class extends st{constructor(t,r,n,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.buffer=new Uint8Array(t),this.view=ct(this.buffer)}update(t){it(this),t=ht(t),Z(t);let{view:r,buffer:n,blockLen:o}=this,i=t.length;for(let s=0;s<i;){let c=Math.min(o-this.pos,i-s);if(c===o){let a=ct(t);for(;o<=i-s;s+=o)this.process(a,s);continue}n.set(t.subarray(s,s+c),this.pos),this.pos+=c,s+=c,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){it(this),$t(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:o,isLE:i}=this,{pos:s}=this;r[s++]=128,J(this.buffer.subarray(s)),this.padOffset>o-s&&(this.process(n,0),s=0);for(let h=s;h<o;h++)r[h]=0;Ue(n,o-8,BigInt(this.length*8),i),this.process(n,0);let c=ct(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=a/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)c.setUint32(4*h,u[h],i)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:o,finished:i,destroyed:s,pos:c}=this;return t.destroyed=s,t.finished=i,t.length=o,t.pos=c,o%r&&t.buffer.set(n),t}clone(){return this._cloneInto()}},$=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);var He=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),q=new Uint32Array(64),wt=class extends gt{constructor(t=32){super(64,t,8,!1),this.A=$[0]|0,this.B=$[1]|0,this.C=$[2]|0,this.D=$[3]|0,this.E=$[4]|0,this.F=$[5]|0,this.G=$[6]|0,this.H=$[7]|0}get(){let{A:t,B:r,C:n,D:o,E:i,F:s,G:c,H:a}=this;return[t,r,n,o,i,s,c,a]}set(t,r,n,o,i,s,c,a){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=i|0,this.F=s|0,this.G=c|0,this.H=a|0}process(t,r){for(let h=0;h<16;h++,r+=4)q[h]=t.getUint32(r,!1);for(let h=16;h<64;h++){let p=q[h-15],g=q[h-2],y=G(p,7)^G(p,18)^p>>>3,b=G(g,17)^G(g,19)^g>>>10;q[h]=b+q[h-7]+y+q[h-16]|0}let{A:n,B:o,C:i,D:s,E:c,F:a,G:l,H:u}=this;for(let h=0;h<64;h++){let p=G(c,6)^G(c,11)^G(c,25),g=u+p+Qt(c,a,l)+He[h]+q[h]|0,b=(G(n,2)^G(n,13)^G(n,22))+te(n,o,i)|0;u=l,l=a,a=c,c=s+g|0,s=i,i=o,o=n,n=g+b|0}n=n+this.A|0,o=o+this.B|0,i=i+this.C|0,s=s+this.D|0,c=c+this.E|0,a=a+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,o,i,s,c,a,l,u)}roundClean(){J(q)}destroy(){this.set(0,0,0,0,0,0,0,0),J(this.buffer)}};var ee=Zt(()=>new wt);var ne=ee;function X(e){let t=new Uint8Array(e);return crypto.getRandomValues(t),t}function re(e,t,r,n=32){let o=new TextEncoder().encode(e);return Yt(ne,o,t,{c:r,dkLen:n})}function St(e,t,r=null,n=new Uint8Array(0)){return r||(r=X(12)),{ciphertext:Ht(e,r,n).encrypt(t),nonce:r}}function jt(e,t,r,n=new Uint8Array(0)){return Ht(e,r,n).decrypt(t)}function ft(e){let t=Array.from(e,r=>String.fromCharCode(r)).join("");return btoa(t)}function at(e){let t=atob(e);return Uint8Array.from(t,r=>r.charCodeAt(0))}function Ft(e,t){let r=[],n=X(t*4),o=new Uint32Array(n.buffer),i=Math.floor(4294967295/e)*e;for(let s=0;s<t;s++){let c=o[s];for(;c>=i;){let a=X(4);c=new Uint32Array(a.buffer)[0]}r.push(c%e)}return r}function Ce(e){let t=[],r=sjcl.bitArray.bitLength(e),n;for(let o=0;o<r/8;o++)o&3||(n=e[o/4]),t.push(n>>>24),n<<=8;return new Uint8Array(t)}function oe(e,t){let r=new sjcl.cipher[e.cipher](t),n=sjcl.mode[e.mode].decrypt(r,e.ct,e.iv,e.adata,e.ts);return Ce(n)}function se(e,t,r){try{let n=new sjcl.cipher[e.cipher](t);return sjcl.mode[e.mode].decrypt(n,r.key,r.iv,e.adata,e.ts)}catch{return null}}function ie(e,t,r,n){return sjcl.misc.pbkdf2(e,t,r,n)}function mt(e){return!e.v||e.v===1||e.mode==="ccm"||e.mode==="ocb2"}var f={salt_length:16,aes_key_strength:32,aes_cipher_mode:"chacha20poly1305",pbkdf2_iterations:5e4,_badngramlist:[],_salt:null,_plaintext:null,_cipherobj:null,_passwords:[],_keys:[],_master:null,_filename:null,_filetype:null,_nPasswords:null,_nToUnlock:null,_lastMetadata:null,_wordlist:[],loadWordlist:function(e,t,r){let n=Date.now(),o=new XMLHttpRequest;o.open("GET",e,!0),o.onreadystatechange=function(){if(o.readyState===4&&o.status===200){f[t]=o.responseText.split(`
`);let i=Date.now();r()}},o.send()},makePassword:function(e){let t=[],r=Ft(f._wordlist.length,e);for(let o=0;o<e;o++)t[o]=f._wordlist[r[o]];let n=t.join(" ");for(let o=0;o<f._badngramlist.length;o++)if(n.indexOf(f._badngramlist[o])!==-1)return f.makePassword(e);return n},randto:function(e,t){return Ft(e,t)},normalizeString:function(e){return e.replace(/\s+/g," ").replace(/(^\s|\s$)/g,"")},makeSalt:function(){f._salt=X(f.salt_length)},makeKeyFromPassword:function(e){return typeof sjcl<"u"&&Array.isArray(f._salt)?ie(e,f._salt,f.pbkdf2_iterations,f.aes_key_strength*8):re(e,f._salt,f.pbkdf2_iterations,f.aes_key_strength)},makeCombinedPasswords:function(e,t){f._nPasswords=e.length,f._nToUnlock=t;let r=function(o,i,s,c,a){if(c<=0)i.push(s.replace(/ /,""));else for(let l=a;l<o.length;l++)r(o,i,[s,o[l]].join(" "),c-1,l+1)},n=[];for(let o=0;o<e.length;o++)e[o]=f.normalizeString(e[o]);return e.sort(),r(e,n,null,t,0),n},makeKeyCombinations:function(e,t,r){r=r||function(o){},f._keys=[];let n=f.makeCombinedPasswords(e,t);r(0);for(let o=0;o<n.length;o++)f._keys.push(f.makeKeyFromPassword(n[o])),r((o+1)/n.length);return r(1),f._keys},makeAESKey:function(){f._master=X(f.aes_key_strength)},makeMetadataObject:function(){let e=X(12);return{adata:"",iter:f.pbkdf2_iterations,mode:f.aes_cipher_mode,cipher:"chacha20",ts:128,ks:f.aes_key_strength*8,salt:f._salt,iv:e,v:2,ct:null,fn:f._filename,ft:f._filetype,nkeys:f._nPasswords,nunlock:f._nToUnlock}},decryptKeys:function(){if(typeof sjcl<"u"&&mt(f._cipherobj))return f.decryptKeysLegacy();let e=!1;for(let t=0;t<f._keys.length;t++){for(let r=0;r<f._cipherobj.keys.length;r++)try{let n=f._cipherobj.keys[r];f._master=jt(f._keys[t],n.key,n.iv,new Uint8Array(0)),e=!0;break}catch{}if(e)break}return e},decryptKeysLegacy:function(){let e=!1;for(let t=0;t<f._keys.length;t++){for(let r=0;r<f._cipherobj.keys.length;r++){let n=se(f._cipherobj,f._keys[t],f._cipherobj.keys[r]);if(n){f._master=n,e=!0;break}}if(e)break}return e},decryptCiphertext:function(){typeof sjcl<"u"&&mt(f._cipherobj)?f._plaintext=oe(f._cipherobj,f._master):f._plaintext=jt(f._master,f._cipherobj.ct,f._cipherobj.iv,new Uint8Array(0))},encryptWithPasswords:function(e,t,r){return f.makeKeyCombinations(e,t,r),f.makeAESKey(),f.encryptPlaintext(f._plaintext)},encryptPlaintext:function(e){let t=f.makeMetadataObject(),r=e||f._plaintext;f._lastMetadata=t;let n=St(f._master,r,t.iv,new Uint8Array(0));return t.ct=n.ciphertext,t.iv=n.nonce,f._cipherobj=t,f.augmentWithEncryptedKeys(f._cipherobj),f.getCipherJSON()},augmentWithEncryptedKeys:function(e){let t=[];for(let r=0;r<f._keys.length;r++){let n=X(12),o=St(f._keys[r],f._master,n,new Uint8Array(0));t.push({iv:o.nonce,key:o.ciphertext})}e.keys=t,f.shuffle(e.keys)},shuffle:function(e){let t=e.length;if(t===0)return!1;for(;--t;){let r=f.randto(t+1,1)[0],n=e[t];e[t]=e[r],e[r]=n}return e},setPlaintext:function(e,t,r){return f._plaintext=new Uint8Array(e),t&&f.setFileName(t),r&&f.setFileType(r),!0},setFileName:function(e){return f._filename=e,f._filename},setFileType:function(e){return f._filetype=e,f._filetype},setPBKDF2Iterations:function(e){f.pbkdf2_iterations=e},setWordlist:function(e){f._wordlist=e},setBadNGramList:function(e){f._badngramlist=e},getFileName:function(){return f._filename},getFileType:function(){return f._filetype},getNPasswords:function(){return f._nPasswords},getNPasswordsDecrypt:function(){return f._cipherobj.nkeys},getNumToUnlock:function(){return f._nToUnlock},getWordlist:function(){return f._wordlist},getBadNGramList:function(){return f._badngramlist},resetKeys:function(){f._keys=[]},isPlaintextReady:function(){return f._plaintext!==null},isCipherObjectReady:function(){return f._cipherobj!==null},setCipherJSON:function(e){let t=JSON.parse(e);if(mt(t)){t.salt=sjcl.codec.base64.toBits(t.salt),t.iv=sjcl.codec.base64.toBits(t.iv),t.ct=sjcl.codec.base64.toBits(t.ct);for(let n=0;n<t.keys.length;n++)t.keys[n].iv=sjcl.codec.base64.toBits(t.keys[n].iv),t.keys[n].key=sjcl.codec.base64.toBits(t.keys[n].key)}else{t.salt=at(t.salt),t.iv=at(t.iv),t.ct=at(t.ct);for(let n=0;n<t.keys.length;n++)t.keys[n].iv=at(t.keys[n].iv),t.keys[n].key=at(t.keys[n].key)}f._salt=t.salt,f._nPasswords=t.nkeys,f._nToUnlock=t.nunlock,f.setFileName(t.fn),f.setFileType(t.ft),f.setPBKDF2Iterations(t.iter),f._cipherobj=t},getCipherJSON:function(){let e={v:f._cipherobj.v,mode:f._cipherobj.mode,cipher:f._cipherobj.cipher,ts:f._cipherobj.ts,ks:f._cipherobj.ks,iter:f._cipherobj.iter,adata:f._cipherobj.adata,fn:f._cipherobj.fn,ft:f._cipherobj.ft,nkeys:f._cipherobj.nkeys,nunlock:f._cipherobj.nunlock,salt:ft(f._cipherobj.salt),iv:ft(f._cipherobj.iv),ct:ft(f._cipherobj.ct),keys:[]};for(let t=0;t<f._cipherobj.keys.length;t++)e.keys.push({iv:ft(f._cipherobj.keys[t].iv),key:ft(f._cipherobj.keys[t].key)});return JSON.stringify(e)},getPlaintext:function(){return f._plaintext},augment:function(e,t){for(let r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}},It=f;typeof window<"u"&&(window.keybearer=f);self.onmessage=function(e){let t=e.data,r=t.f,n=t.p||[];t.c&&n.push(function(s){self.postMessage({f:r,c:s})});let i=It[r].apply(It,n);i!==void 0&&self.postMessage({f:r,r:i})};})();
/*! Bundled license information:

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
